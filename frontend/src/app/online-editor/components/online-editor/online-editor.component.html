<div class="werckmeister-online-editor" [ngClass]="{'is-dirty': !workspaceIsClean}">
    <button class="has-dirty-workspace-mark" (click)="save()">Save</button>
    <werckmeister-workspace #workspace></werckmeister-workspace>
    <div class="editor-main" #editorMain>
        <div class="filelist">
            <div class="filemenu">
                <button id="newFileButton" 
                    nz-button 
                    nzType="default" 
                    nzShape="circle"
                    nzSize="small"
                    nz-popover 
                    nzPopoverTitle="Add New File"
                    [nzPopoverContent]="newFileTemplate">
                    <i nz-icon nzType="plus"></i>
                </button>
            </div>
            <hr>
            <ul>
                <li (click)="onFileClicked(file)" *ngFor="let file of files">
                    <ngwerckmeister-file-entry
                        [isValidPath]="isValidPath.bind(this)" 
                        (nameChange)="onFileNameChanged(file, $event)" 
                        [name]="file.path">
                    </ngwerckmeister-file-entry>
                </li>
                <li>
                    <ngwerckmeister-file-entry *ngIf="!!newFile" 
                        [editMode]="true"
                        [isValidPath]="isValidPath.bind(this)" 
                        (nameChange)="onNewFileAdded(newFile, $event)" 
                        (oncancel)="onNewFileCancel()"
                        [name]="newFile.path"
                    ></ngwerckmeister-file-entry>
                </li>
            </ul>
        </div>
        <werckmeister-editor [ngClass]="{active: currentFile===file}" *ngFor="let file of files" [attr.wm-filename]="file.path" wm-style="height: 100%; width: 100%;">
        </werckmeister-editor>
    </div>
</div>

<ng-template #titleTemplate><i nz-icon nzType="close"></i> Title</ng-template>
<ng-template #newFileTemplate>
    <ul class="new-file-list">
        <li><a (click)="onAddNewAccompaniment()">Accompaniment Template</a></li>
        <li><a (click)="onAddNewPitchMap()">Pitch Map</a></li>
        <li><a (click)="onAddNewVoicingScript()">Voicing Script</a></li>
        <li><a (click)="onAddNewModScript()">Mod Script</a></li>
    </ul>
</ng-template>